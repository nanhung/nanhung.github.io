<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Acetaminophen-PBPK model • pksensi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Acetaminophen-PBPK model">
<meta property="og:description" content="pksensi">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pksensi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pbpk_apap.html">Acetaminophen-PBPK model</a>
    </li>
    <li>
      <a href="../articles/pbtk1cpt.html">One-compartment PK model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nanhung/pksensi/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Acetaminophen-PBPK model</h1>
                        <h4 data-toc-skip class="author">Nan-Hung Hsieh</h4>
            
            <h4 data-toc-skip class="date">2022-09-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nanhung/pksensi/blob/HEAD/vignettes/pbpk_apap.Rmd" class="external-link"><code>vignettes/pbpk_apap.Rmd</code></a></small>
      <div class="hidden name"><code>pbpk_apap.Rmd</code></div>

    </div>

    
    
<p>The aim of this vignette is to reproduce our previous published <span class="citation">(Hsieh et al. 2018)</span> result of global sensitivity analysis for acetaminophen PBPK model through <strong>pksensi</strong>. The model codes are included in this package and can be generated through <code><a href="../reference/models.html">pbpk_apap_model()</a></code>. We applied the global sensitivity analysis workflow to the original published model with 21 model parameters <span class="citation">(Zurlinden and Reisfeld 2016)</span>. The descriptions of each parameter and the sampling ranges are list in Table 1.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mcsim.html">mcsim_install</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"6.1.0"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Start install</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking...</span></span></code></pre>
<pre><code><span><span class="co">#&gt; C:\Users\lanhsieh\DOCUME~1\mcsim\mod.exe</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The MCSim 6.1.0 is installed.</span></span></code></pre>
<pre><code><span><span class="co">#&gt; The sourced folder is under C:/Users/lanhsieh/Documents/mcsim-6.1.0</span></span></code></pre>
<table class="table">
<caption>
Table 1 Description of sampling range of model parameter
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Unit
</th>
<th style="text-align:center;">
Min
</th>
<th style="text-align:center;">
Max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Tg
</td>
<td style="text-align:left;">
Gatric emptying time constant
</td>
<td style="text-align:left;">
<span class="math inline">\(h\)</span>
</td>
<td style="text-align:center;">
-3.430
</td>
<td style="text-align:center;">
0.490
</td>
</tr>
<tr>
<td style="text-align:left;">
Tp
</td>
<td style="text-align:left;">
GI perfusion time constant
</td>
<td style="text-align:left;">
<span class="math inline">\(h\)</span>
</td>
<td style="text-align:center;">
-5.371
</td>
<td style="text-align:center;">
-1.451
</td>
</tr>
<tr>
<td style="text-align:left;">
CYP_Km
</td>
<td style="text-align:left;">
Cytochrome P450 metabolism, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
3.000
</td>
<td style="text-align:center;">
7.000
</td>
</tr>
<tr>
<td style="text-align:left;">
CYP_VmaxC
</td>
<td style="text-align:left;">
Cytochrome P450 metabolism, VMax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-1.966
</td>
<td style="text-align:center;">
7.972
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_Km_apap
</td>
<td style="text-align:left;">
Sulfation pathway acetaminophen, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
3.744
</td>
<td style="text-align:center;">
7.664
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_Ki
</td>
<td style="text-align:left;">
Sulfation pathway substrate inhibition, Ki
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
4.305
</td>
<td style="text-align:center;">
8.225
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_Km_paps
</td>
<td style="text-align:left;">
Sulfation pathway PAPS, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
-3.000
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_VmaxC
</td>
<td style="text-align:left;">
Sulfation pathway acetaminophen, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
10.000
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_Km
</td>
<td style="text-align:left;">
Glucronidation pathway acetaminophen, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
6.740
</td>
<td style="text-align:center;">
10.660
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_Ki
</td>
<td style="text-align:left;">
Glucronidation pathway substrate inhibition, Ki
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
9.008
</td>
<td style="text-align:center;">
12.928
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_Km_GA
</td>
<td style="text-align:left;">
Glucronidation pathway GA, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
-3.000
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_VmaxC
</td>
<td style="text-align:left;">
Glucronidation pathway acetaminophen, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
10.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Km_AG
</td>
<td style="text-align:left;">
APAP-G hepatic transporter, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
7.938
</td>
<td style="text-align:center;">
11.858
</td>
</tr>
<tr>
<td style="text-align:left;">
Vmax_AG
</td>
<td style="text-align:left;">
APAP-G hepatic transporter, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\)</span>
</td>
<td style="text-align:center;">
6.994
</td>
<td style="text-align:center;">
14.997
</td>
</tr>
<tr>
<td style="text-align:left;">
Km_AS
</td>
<td style="text-align:left;">
APAP-S hepatic transporter, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
8.000
</td>
<td style="text-align:center;">
12.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Vmax_AS
</td>
<td style="text-align:left;">
APAP-S hepatic transporter, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\)</span>
</td>
<td style="text-align:center;">
6.994
</td>
<td style="text-align:center;">
14.997
</td>
</tr>
<tr>
<td style="text-align:left;">
kGA_syn
</td>
<td style="text-align:left;">
UDPGA synthesis
</td>
<td style="text-align:left;">
<span class="math inline">\(1/h\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
13.001
</td>
</tr>
<tr>
<td style="text-align:left;">
PAPS_syn
</td>
<td style="text-align:left;">
PAPS synthesis
</td>
<td style="text-align:left;">
<span class="math inline">\(1/h\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
13.001
</td>
</tr>
<tr>
<td style="text-align:left;">
CLC_APAP
</td>
<td style="text-align:left;">
APAP clearance
</td>
<td style="text-align:left;">
<span class="math inline">\(L/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-5.999
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
CLC_AG
</td>
<td style="text-align:left;">
APAP-G clearance
</td>
<td style="text-align:left;">
<span class="math inline">\(L/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-5.999
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
CLC_AS
</td>
<td style="text-align:left;">
APAP-S clearance
</td>
<td style="text-align:left;">
<span class="math inline">\(L/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-5.999
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
</tbody>
</table>
<p>Same as the example of one-compartment PK model. The model parameter and the corresponding sampling range should be defined to create the parameter matrix. Previously, the probability distributions of model parameters were set to either truncated normal or uniform distribution when the parameters have informative prior information or not. To rapidly reach the acceptance convergence, we apply uniform distribution for all testing parameters. The ranges of informative parameters are set to 1.96-times difference for single side under log-scaled (approximate 54.6 times difference between minimum and maximum in natural scaled). The nominal values of informative model parameters were defined as:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nominal value</span></span>
<span><span class="va">Tg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.23</span><span class="op">)</span></span>
<span><span class="va">Tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.033</span><span class="op">)</span></span>
<span><span class="va">CYP_Km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span></span>
<span><span class="va">SULT_Km_apap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">SULT_Ki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">526</span><span class="op">)</span></span>
<span><span class="va">SULT_Km_paps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">UGT_Km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">6.0e3</span><span class="op">)</span></span>
<span><span class="va">UGT_Ki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">5.8e4</span><span class="op">)</span></span>
<span><span class="va">UGT_Km_GA</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">Km_AG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.99e4</span><span class="op">)</span></span>
<span><span class="va">Km_AS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.29e4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rng</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> </span></code></pre></div>
<p>Generally, wide range of parameter value might cause the computing error when solving the differential equation. One of the effective ways to prevent this problem is to adjust the value of relative and absolute error tolerance to control the error appearance by resetting these parameters in a lower value. The <code><a href="../reference/solve_mcsim.html">generate_infile()</a></code> and <code><a href="../reference/solve_mcsim.html">solve_mcsim()</a></code> provide the arguments of <code>rtol</code> and <code>atol</code> that adjust the error tolerance to prevent the unwanted error. However, the modification will decrease the computing speed. Therefore, the alternative method to prevent this issue is to detect the crucial parameter range that causes the problem. Also, setting the maximum number of steps to higher value instead of using the default value (500) in <strong>GNU MCSim</strong> can prevent this problem (internally defined). The maximum number of step is set to 5000 in this case. Here we separate the global SA of APAP-PBPK model process to several steps.</p>
<div class="section level2">
<h2 id="prepare-and-compile-the-model-file">Prepare and compile the model file<a class="anchor" aria-label="anchor" href="#prepare-and-compile-the-model-file"></a>
</h2>
<p>The model code needs to be prepared in the following global SA workflow. After creating the <code>pbpk_apap.model</code> file in the working directory, the next step is to generate the executable program (<code>mcsim.pbpk_apap</code>) through <code><a href="../reference/compile_model.html">compile_model()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mName</span> <span class="op">&lt;-</span> <span class="st">"pbpk_apap"</span></span>
<span><span class="fu"><a href="../reference/models.html">pbpk_apap_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/compile_model.html">compile_model</a></span><span class="op">(</span><span class="va">mName</span>, application <span class="op">=</span> <span class="st">"mcsim"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Generating C model file...</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Creating modeling program...</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Done.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="define-the-parameter-and-its-distribution">Define the parameter and its distribution<a class="anchor" aria-label="anchor" href="#define-the-parameter-and-its-distribution"></a>
</h2>
<p>The 21 testing model parameters are defined in this part, including parameter name, probability distribution, and distributed parameter value. To prevent the computing error, the range of <code>SULT_VmaxC</code> and <code>UGT_VmaxC</code> need to adjust from <span class="math inline">\(U(0, 15)\)</span> <span class="citation">(Zurlinden and Reisfeld 2016)</span> to <span class="math inline">\(U(0, 10)\)</span> <span class="citation">(Hsieh et al. 2018)</span>. The objects <code>q</code> and <code>dist</code> are set to the type of distribution that will use to generate the parameter matrix in <strong>GNU MCSim</strong> (for uncertainty analysis) and R (for SA).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnTg"</span>, <span class="st">"lnTp"</span>, <span class="st">"lnCYP_Km"</span>,<span class="st">"lnCYP_VmaxC"</span>,</span>
<span>           <span class="st">"lnSULT_Km_apap"</span>,<span class="st">"lnSULT_Ki"</span>,<span class="st">"lnSULT_Km_paps"</span>,<span class="st">"lnSULT_VmaxC"</span>,</span>
<span>           <span class="st">"lnUGT_Km"</span>,<span class="st">"lnUGT_Ki"</span>,<span class="st">"lnUGT_Km_GA"</span>,<span class="st">"lnUGT_VmaxC"</span>,</span>
<span>           <span class="st">"lnKm_AG"</span>,<span class="st">"lnVmax_AG"</span>,<span class="st">"lnKm_AS"</span>,<span class="st">"lnVmax_AS"</span>,</span>
<span>           <span class="st">"lnkGA_syn"</span>,<span class="st">"lnkPAPS_syn"</span>, <span class="st">"lnCLC_APAP"</span>,<span class="st">"lnCLC_AG"</span>,<span class="st">"lnCLC_AS"</span><span class="op">)</span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Uniform"</span>, <span class="fl">21</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"qunif"</span>, <span class="fl">21</span><span class="op">)</span></span>
<span><span class="va">q.arg</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Tg</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Tg</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Tp</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Tp</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">CYP_Km</span><span class="op">-</span><span class="va">rng</span>, <span class="va">CYP_Km</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.</span>, <span class="fl">5.</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">SULT_Km_apap</span><span class="op">-</span><span class="va">rng</span>, <span class="va">SULT_Km_apap</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">SULT_Ki</span><span class="op">-</span><span class="va">rng</span>, <span class="va">SULT_Ki</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">SULT_Km_paps</span><span class="op">-</span><span class="va">rng</span>, <span class="va">SULT_Km_paps</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UGT_Km</span><span class="op">-</span><span class="va">rng</span>, <span class="va">UGT_Km</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UGT_Ki</span><span class="op">-</span><span class="va">rng</span>, <span class="va">UGT_Ki</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UGT_Km_GA</span><span class="op">-</span><span class="va">rng</span>, <span class="va">UGT_Km_GA</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Km_AG</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Km_AG</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7.</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Km_AS</span><span class="op">-</span><span class="va">rng</span>, <span class="va">Km_AS</span><span class="op">+</span><span class="va">rng</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7.</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">13</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6.</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6.</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6.</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-additional-input-condition-and-output-time-and-variables">Define additional input condition and output time and variables<a class="anchor" aria-label="anchor" href="#define-additional-input-condition-and-output-time-and-variables"></a>
</h2>
<p>To optimize the computing speed, this case only uses <strong>GNU MCSim</strong> to estimate the concentration of APAP and its metabolites glucuronide (APAP-G) and sulfate (APAP-S) in plasma. The setting oral dose of APAP is 20 mg/kg in this example. Generally, the input dosing method can be defined through the <code>condition</code> argument. Since the unit of the given dose is mg/kg, the <code>mgkg_flag</code> is set to 1. More definition of input schedule functions can be found in the section of input functions in <strong>GNU MCSim</strong> User’s Manual (<a href="https://www.gnu.org/software/mcsim/mcsim.html#Input-functions" class="external-link uri">https://www.gnu.org/software/mcsim/mcsim.html#Input-functions</a>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mgkg_flag = 1"</span>,</span>
<span>                <span class="st">"OralExp_APAP = NDoses(2, 1, 0, 0, 0.001)"</span>,</span>
<span>                <span class="st">"OralDose_APAP_mgkg = 20.0"</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnCPL_APAP_mcgL"</span>, <span class="st">"lnCPL_AG_mcgL"</span>, <span class="st">"lnCPL_AS_mcgL"</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="uncertainty-analysis">Uncertainty analysis<a class="anchor" aria-label="anchor" href="#uncertainty-analysis"></a>
</h2>
<p>We apply uncertainty analysis through the <code><a href="../reference/solve_mcsim.html">solve_mcsim()</a></code> and visualize the result by <code><a href="../reference/pksim.html">pksim()</a></code> function. Some example data are included in the <strong>pksensi</strong> with experiment time (h) and concentration (mg/L).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   Wt Time     APAP        AG       AS         Study Dose</span></span>
<span><span class="co">#&gt; 1 72 0.25 15.50007  3.204143 3.548570 Prescott_1980   20</span></span>
<span><span class="co">#&gt; 2 72 0.50 18.70040  7.945810 6.745292 Prescott_1980   20</span></span>
<span><span class="co">#&gt; 3 72 0.75 18.79977 13.422665 8.214039 Prescott_1980   20</span></span>
<span><span class="co">#&gt; 4 72 1.00 17.99951 18.142273 9.559589 Prescott_1980   20</span></span>
<span><span class="co">#&gt; 5 72 1.50 15.59959 24.681272 9.345965 Prescott_1980   20</span></span>
<span><span class="co">#&gt; 6 72 2.00 13.59966 27.279751 8.779722 Prescott_1980   20</span></span></code></pre>
<p>In the setting condition of simulation, The relative and absolute error tolerance (<code>rtol</code> &amp; <code>atol</code>) were set to 1e-7 and 1e-9, respectively, to prevent the computing error. The Monte Carlo simulation is run for 1000 iteration as the assignment of <code>monte_carlo</code>. The input file (‘sim.in’) and output file (‘simmc.out’) will be generated under the standard ASCII format.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1111</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_mcsim.html">solve_mcsim</a></span><span class="op">(</span>mName <span class="op">=</span> <span class="va">mName</span>, params <span class="op">=</span> <span class="va">params</span>, vars <span class="op">=</span> <span class="va">vars</span>,</span>
<span>                   monte_carlo <span class="op">=</span> <span class="fl">1000</span>, dist <span class="op">=</span> <span class="va">dist</span>, q.arg <span class="op">=</span> <span class="va">q.arg</span>, </span>
<span>                   time <span class="op">=</span> <span class="va">times</span>, condition <span class="op">=</span> <span class="va">conditions</span>, </span>
<span>                   rtol <span class="op">=</span> <span class="fl">1e-7</span>, atol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Starting time: 2022-09-22 15:50:21</span></span></code></pre>
<pre><code><span><span class="co">#&gt; * Created input file "sim.in".</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Execute: ./mcsim.pbpk_apap.model.exe sim.in</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Ending time: 2022-09-22 15:50:23</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pksim.html">pksim</a></span><span class="op">(</span><span class="va">out</span>, xlab <span class="op">=</span> <span class="st">"Time (h)"</span>, ylab <span class="op">=</span> <span class="st">"Conc. (ug/L)"</span>, main <span class="op">=</span> <span class="st">"APAP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">Time</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">APAP</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pksim.html">pksim</a></span><span class="op">(</span><span class="va">out</span>, vars <span class="op">=</span> <span class="st">"lnCPL_AG_mcgL"</span>, xlab <span class="op">=</span> <span class="st">"Time (h)"</span>, main <span class="op">=</span> <span class="st">"APAP-G"</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">" "</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">Time</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">AG</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pksim.html">pksim</a></span><span class="op">(</span><span class="va">out</span>, vars <span class="op">=</span> <span class="st">"lnCPL_AS_mcgL"</span>, xlab <span class="op">=</span> <span class="st">"Time (h)"</span>, main <span class="op">=</span> <span class="st">"APAP-S"</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">" "</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">Time</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">APAP</span><span class="op">$</span><span class="va">AS</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="pbpk_apap_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Here shows the coverage checks of prior PBPK model predictions with calibrated APAP data. For parent compound, all data points are located in the simulated interval of 25-75%. Through this result, we can determine that the simulated outputs can accurately generate the same concentration profile as the in-vivo experiment under the setting of parameter ranges for APAP. The simulated result of metabolites APAP-G shows the different pharmacokinetic profile with experiment data. However, all data points are located in the simulated interval.</p>
</div>
<div class="section level2">
<h2 id="generate-parameter-matrix">Generate parameter matrix<a class="anchor" aria-label="anchor" href="#generate-parameter-matrix"></a>
</h2>
<p>In global SA, we have to additionally generate the parameter matrix from the eFAST method. The current setting uses 512 sample size with 10 replication.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfast99.html">rfast99</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">params</span>, n <span class="op">=</span> <span class="fl">512</span>, q <span class="op">=</span> <span class="va">q</span>, q.arg <span class="op">=</span> <span class="va">q.arg</span>, replicate <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conduct-the-global-sa">Conduct the global SA<a class="anchor" aria-label="anchor" href="#conduct-the-global-sa"></a>
</h2>
<p>To conduct the global SA with <strong>GNU MCSim</strong> and <strong>pksensi</strong>, the input file with given “setpoint” condition should be generated before modeling. The file can create by <code>generate_infile</code> function. The <code>solve_mcsim</code> can also automatically create the input file and compute the output.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_mcsim.html">solve_mcsim</a></span><span class="op">(</span><span class="va">x</span>, mName <span class="op">=</span> <span class="va">mName</span>,</span>
<span>                   params <span class="op">=</span> <span class="va">params</span>, </span>
<span>                   time <span class="op">=</span> <span class="va">times</span>, </span>
<span>                   vars <span class="op">=</span> <span class="va">vars</span>,</span>
<span>                   condition <span class="op">=</span> <span class="va">conditions</span>, </span>
<span>                   rtol <span class="op">=</span> <span class="fl">1e-7</span>, atol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Starting time: 2022-09-22 15:50:25</span></span></code></pre>
<pre><code><span><span class="co">#&gt; * Created input file "sim.in".</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Execute: ./mcsim.pbpk_apap.model.exe sim.in</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Ending time: 2022-09-22 15:53:09</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="visualization-and-decision">Visualization and decision<a class="anchor" aria-label="anchor" href="#visualization-and-decision"></a>
</h2>
<p>The plotting function can create the result of time-dependent sensitivity measurement to determine the parameter impact on model output over time.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, vars <span class="op">=</span> <span class="st">"lnCPL_APAP_mcgL"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pbpk_apap_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>In addition, through using the <code>check</code>, the parameter with sensitivity and convergence indices over the given condition can be preliminary detected for all output variables. Based on our previous study, we proposed the heatmap visualization approach <code>heat_check</code> to distinguish “influential” and “non-influential” parameters with a “cut-off” point. Through the given argument <code>order</code>, we can select the specific order of sensitivity measurement that we’re interested in.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check.html">heat_check</a></span><span class="op">(</span><span class="va">out</span>, order <span class="op">=</span> <span class="st">"total order"</span>, show.all <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="pbpk_apap_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>In the default setting, the <code>heat_check</code> can only show the influential parameters. The argument <code>show.all</code> is used to show all results. Adding the <code>index = "CI"</code> in the function can further investigate the convergence index. Based on the current setting of sampling size, most parameters cannot reach the acceptable criteria of convergence. Therefore, a higher number of sampling is necessary. The sample size of convergence in the current PBPK model is 8,192 <span class="citation">(Hsieh et al. 2018)</span>. However, based on the current sample size we still can find 6 parameters that can be an important parameter for the plasma APAP concentration.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check.html">heat_check</a></span><span class="op">(</span><span class="va">out</span>, index <span class="op">=</span> <span class="st">"CI"</span>, order <span class="op">=</span> <span class="st">"total order"</span><span class="op">)</span></span></code></pre></div>
<p><img src="pbpk_apap_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fphar201800588" class="csl-entry">
Hsieh, Nan-Hung, Brad Reisfeld, Frederic Y. Bois, and Weihsueh A. Chiu. 2018. <span>“Applying a Global Sensitivity Analysis Workflow to Improve the Computational Efficiencies in Physiologically-Based Pharmacokinetic Modeling.”</span> <em>Frontiers in Pharmacology</em> 9: 588. <a href="https://doi.org/10.3389/fphar.2018.00588" class="external-link">https://doi.org/10.3389/fphar.2018.00588</a>.
</div>
<div id="ref-s13318-015-0253-x" class="csl-entry">
Zurlinden, Todd J., and Brad Reisfeld. 2016. <span>“Physiologically Based Modeling of the Pharmacokinetics of Acetaminophen and Its Major Metabolites in Humans Using a Bayesian Population Approach.”</span> <em>European Journal of Drug Metabolism and Pharmacokinetics</em> 41: 267–80. <a href="https://doi.org/10.1007/s13318-015-0253-x" class="external-link">https://doi.org/10.1007/s13318-015-0253-x</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nan-Hung Hsieh.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
